# –ö–∞–∫ –∏ –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Concurrent –∫–æ–ª–ª–µ–∫—Ü–∏–∏

## –ß—Ç–æ —ç—Ç–æ
**Concurrent-–∫–æ–ª–ª–µ–∫—Ü–∏–∏** ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø–æ—Ç–æ–∫–æ-–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏–∑ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º—ë–Ω  
`System.Collections.Concurrent`.  
–û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç **–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —á–∏—Ç–∞—Ç—å –∏ –∏–∑–º–µ–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ** –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `lock`.

---

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã
| –ö–æ–ª–ª–µ–∫—Ü–∏—è                           | –ü–æ–≤–µ–¥–µ–Ω–∏–µ                                                        | –ê–Ω–∞–ª–æ–≥ –±–µ–∑ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |
| ----------------------------------- | ---------------------------------------------------------------- | ----------------------------- |
| `ConcurrentDictionary<TKey,TValue>` | –°–ª–æ–≤–∞—Ä—å, –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π                    | `Dictionary<TKey,TValue>`     |
| `ConcurrentQueue<T>`                | –û—á–µ—Ä–µ–¥—å (FIFO)                                                   | `Queue<T>`                    |
| `ConcurrentStack<T>`                | –°—Ç–µ–∫ (LIFO)                                                      | `Stack<T>`                    |
| `ConcurrentBag<T>`                  | –ú–µ—à–æ–∫ ‚Äî –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫                                   | ‚Äî                             |
| `BlockingCollection<T>`             | –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ –¥—Ä—É–≥–∏–º–∏ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏ –ª–∏–º–∏—Ç–∞ | ‚Äî                             |

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### üîπ ConcurrentDictionary
–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫—ç—à–µ–π, –ø–æ–¥—Å—á—ë—Ç–æ–≤ –∏ —Ä–∞–±–æ—Ç—ã —Å –æ–±—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
```csharp
var cache = new ConcurrentDictionary<string, int>();

cache.TryAdd("a", 1);
cache.AddOrUpdate("a", 1, (_, old) => old + 1);
Console.WriteLine(cache["a"]); // 2
```
–ë–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤.

---

### üîπ ConcurrentQueue
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π –∑–∞–¥–∞—á, –ª–æ–≥–æ–≤ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
```csharp
var queue = new ConcurrentQueue<int>();
queue.Enqueue(1);

if (queue.TryDequeue(out var item))
    Console.WriteLine(item);
```
–£–¥–æ–±–Ω–æ –≤ –ø—Ä–æ–¥—é—Å–µ—Ä‚Äì–∫–æ–Ω—Å—å—é–º–µ—Ä –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö.

---

### üîπ ConcurrentBag
–ü–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –ø–æ—Ä—è–¥–æ–∫ –Ω–µ –≤–∞–∂–µ–Ω, –Ω–æ –Ω—É–∂–Ω–∞ –≤—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ –ø–æ—Ç–æ–∫–æ–≤.
```csharp
var bag = new ConcurrentBag<string>();
bag.Add("test");

if (bag.TryTake(out var value))
    Console.WriteLine(value);
```
–≠–ª–µ–º–µ–Ω—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ –ª–æ–∫–∞–ª—å–Ω—ã–º –∫–æ–ª–ª–µ–∫—Ü–∏—è–º, —Å–Ω–∏–∂–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

---

### üîπ BlockingCollection

–ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∏ **–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫–∏**, –µ—Å–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∞.  
–û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ **Producer‚ÄìConsumer**.
```csharp
var tasks = new BlockingCollection<int>(boundedCapacity: 10);

Task.Run(() =>
{
    foreach (var t in tasks.GetConsumingEnumerable())
        Console.WriteLine($"–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {t}");
});

for (int i = 0; i < 20; i++)
    tasks.Add(i);
    
tasks.CompleteAdding();

```
---

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π **Concurrent**-–∫–æ–ª–ª–µ–∫—Ü–∏–∏, –µ—Å–ª–∏:

- –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ **–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —á–∏—Ç–∞—é—Ç –∏ –∏–∑–º–µ–Ω—è—é—Ç** –¥–∞–Ω–Ω—ã–µ.
- –ù–µ —Ö–æ—á–µ—à—å –≤—Ä—É—á–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø (`lock`, `Monitor`).
- –í–∞–∂–Ω–æ **–º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** –∏ –ø–æ–≤—ã—Å–∏—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å.

‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π, –µ—Å–ª–∏:

- –†–∞–±–æ—Ç–∞ –∏–¥—ë—Ç –≤ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ.
- –ù—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π.
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ—Ä—è–¥–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–∫—Ä–æ–º–µ `Queue` –∏ `Stack`).

---

üí° **–ò—Ç–æ–≥:**  
Concurrent-–∫–æ–ª–ª–µ–∫—Ü–∏–∏ ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–π —Å—Ä–µ–¥–µ.  
–í—ã–±–∏—Ä–∞–π —Ç–∏–ø –ø–æ –∑–∞–¥–∞—á–µ:

- —Å–ª–æ–≤–∞—Ä—å ‚Üí `ConcurrentDictionary`
- –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á ‚Üí `ConcurrentQueue`
- –ø—É–ª –æ–±—ä–µ–∫—Ç–æ–≤ ‚Üí `ConcurrentBag`
- –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–∞—è –æ—á–µ—Ä–µ–¥—å ‚Üí `BlockingCollection`.

